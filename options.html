<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="app.title">UI Builder với Gemini AI</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="app-header">
      <div class="logo">
        <span class="logo-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3l1.912 5.813a2 2 0 001.275 1.275L21 12l-5.813 1.912a2 2 0 00-1.275 1.275L12 21l-1.912-5.813a2 2 0 00-1.275-1.275L3 12l5.813-1.912a2 2 0 001.275-1.275L12 3z"/></svg>
        </span>
        <h1 data-i18n="app.title">UI Builder với Gemini AI</h1>
      </div>
      <div class="header-actions">
        <div class="lang-toggle" id="langToggle">
          <span class="lang-toggle-option active" data-lang="vi">VI</span>
          <span class="lang-toggle-option" data-lang="en">EN</span>
          <div class="lang-toggle-slider"></div>
        </div>
        <button id="deployBtn" class="btn-header-deploy btn-deploy" data-i18n-title="deploy.title" title="Deploy lên Netlify">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 00-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 012-3.95A12.88 12.88 0 0122 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 01-4 2z"/></svg>
          <span data-i18n="deploy.button">Deploy</span>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Left Panel - Preview -->
      <section class="panel preview-panel">
        <div class="panel-header">
          <h2>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
            <span data-i18n="preview.heading">Preview</span>
          </h2>
          <div class="panel-actions">
            <button id="inspectBtn" class="btn-icon btn-inspect" data-i18n-title="inspect.title" title="Inspect & Chọn phần tử">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
            </button>
            <button id="refreshPreview" class="btn-icon" data-i18n-title="refresh.title" title="Refresh">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
            </button>
            <button id="openNewTab" class="btn-icon" data-i18n-title="openTab.title" title="Mở tab mới">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
            </button>
            <button id="downloadHtml" class="btn-icon" data-i18n-title="download.title" title="Tải xuống">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
            <button id="copyHtml" class="btn-icon" data-i18n-title="copyHtml.title" title="Copy HTML">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
            </button>
          </div>
        </div>
        <!-- Netlify Connect Panel -->
        <div id="netlifyPanel" class="netlify-panel hidden">
          <div class="netlify-panel-content">
            <span class="netlify-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
              <span data-i18n="netlify.label">Kết nối Netlify để deploy</span>
            </span>
            <div class="netlify-help">
              <button id="netlifyOpenBtn" class="btn-normal btn-netlify-open">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                <span data-i18n="netlify.step1">Bước 1: Mở Netlify</span>
              </button>
              <span data-i18n="netlify.step1Hint">Tạo token tại mục Personal Access Tokens</span>
            </div>
            <div class="netlify-token-row">
              <input type="password" id="netlifyTokenInput" data-i18n-placeholder="netlify.step2Placeholder" placeholder="Bước 2: Paste token vào đây..." autocomplete="off" />
              <button id="netlifyConnectBtn" class="btn-normal" data-i18n="netlify.connect">Kết nối</button>
            </div>
          </div>
          <button id="netlifyPanelClose" class="btn-clear-selection" data-i18n-title="netlify.closeTitle" title="Đóng">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
        <!-- Deployed URL Bar -->
        <div id="deployedUrlBar" class="deployed-url-bar hidden">
          <span class="deployed-label">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
            <span data-i18n="netlify.liveLabel">Live</span>
          </span>
          <a id="deployedUrl" href="#" target="_blank" class="deployed-link"></a>
          <button id="copyDeployedUrl" class="btn-icon btn-copy-url" data-i18n-title="netlify.copyUrlTitle" title="Copy URL">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          </button>
          <button id="disconnectNetlify" class="btn-icon btn-disconnect" data-i18n-title="netlify.disconnectTitle" title="Ngắt kết nối Netlify">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.36 6.64a9 9 0 11-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
          </button>
        </div>
        <!-- Selected Element Info -->
        <div id="selectedElementInfo" class="selected-element-info hidden">
          <div class="selected-element-header">
            <span class="selected-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
              <span data-i18n="editing.label">Đang chỉnh sửa:</span>
            </span>
            <button id="clearSelection" class="btn-clear-selection" data-i18n-title="editing.clearTitle" title="Bỏ chọn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </div>
          <div class="selected-element-details">
            <code id="selectedSelector"></code>
          </div>
        </div>
        <!-- Device Preview Toolbar -->
        <div class="device-toolbar">
          <button class="device-btn active" data-device="desktop" data-i18n-title="device.desktop" title="Desktop (100%)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
          </button>
          <button class="device-btn" data-device="tablet" data-i18n-title="device.tablet" title="Tablet (768px)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
          </button>
          <button class="device-btn" data-device="mobile" data-i18n-title="device.mobile" title="Mobile (375px)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
          </button>
          <span class="device-size-label" id="deviceSizeLabel">Desktop</span>
        </div>
        <div class="preview-container">
          <iframe id="previewFrame"></iframe>
        </div>
      </section>

      <!-- Right Panel - Controls -->
      <section class="panel control-panel">
        <!-- Page Section (replaces Connection Section) -->
        <div class="section page-section">
          <div class="section-header">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            <span data-i18n="pages.heading">Pages</span>
            <button id="newPageBtn" class="btn-small" data-i18n-title="pages.newTitle" title="Tạo page mới">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              <span data-i18n="pages.newBtn">Mới</span>
            </button>
          </div>
          <div class="section-content page-list-container">
            <div id="pageList" class="page-list"></div>
          </div>
        </div>

        <!-- History Section -->
        <div class="section history-section">
          <div class="section-header">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            <span data-i18n="history.heading">Lịch sử</span>
            <button id="clearHistory" class="btn-clear" data-i18n-title="history.clearTitle" title="Xóa lịch sử">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
            </button>
          </div>
          <div id="historyList" class="history-list"></div>
        </div>

        <!-- Prompt Section -->
        <div class="section prompt-section">
          <div class="section-header">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>
            <span data-i18n="prompt.heading">Mô tả HTML</span>
            <span id="editModeLabel" class="edit-mode-label hidden">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              <span data-i18n="prompt.editModeLabel">Chế độ sửa phần tử</span>
            </span>
          </div>
          <div class="section-content">
            <div class="prompt-wrapper">
              <textarea
                id="promptInput"
                autocomplete="off"
                data-i18n-placeholder="prompt.placeholder"
                placeholder="Ví dụ: Tạo trang landing page cho quán cà phê với màu nâu ấm áp, có hero section với hình nền gradient, menu sản phẩm dạng card, và footer với thông tin liên hệ..."
              ></textarea>
              <div class="prompt-ghost" id="promptGhost" aria-hidden="true"><span class="ghost-typed" id="ghostTyped"></span><span class="ghost-suggestion" id="ghostSuggestion"></span></div>
            </div>
            <div class="prompt-actions">
              <div class="model-toggle" id="modelToggle" data-i18n-title="model.title" title="Chế độ AI">
                <span class="model-toggle-option active" data-value="flash" data-i18n="model.fast">Nhanh</span>
                <span class="model-toggle-option" data-value="thinking" data-i18n="model.thinking">Tư duy</span>
                <div class="model-toggle-slider"></div>
              </div>
              <button id="generateBtn" class="btn btn-primary">
                <span class="btn-text">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 00-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 012-3.95A12.88 12.88 0 0122 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 01-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>
                  <span data-i18n="generate.btn">Tạo HTML</span>
                </span>
                <span class="btn-loading">
                  <svg class="spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg>
                  <span data-i18n="generate.loading">Đang tạo...</span>
                </span>
              </button>
            </div>
          </div>
        </div>

      </section>
    </main>
    <!-- Link Navigation Modal -->
    <div id="linkModal" class="link-modal-overlay hidden">
      <div class="link-modal">
        <div class="link-modal-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="12" y2="12"/><line x1="15" y1="15" x2="12" y2="12"/></svg>
        </div>
        <h3 class="link-modal-title" data-i18n="linkModal.title">Tạo trang mới</h3>
        <p class="link-modal-desc">
          <span data-i18n="linkModal.descBefore">Trang </span><strong id="linkModalPageName"></strong><span data-i18n="linkModal.descAfter"> chưa tồn tại.</span><br>
          <span data-i18n="linkModal.descPrompt">Mô tả nội dung bạn muốn tạo:</span>
        </p>
        <div class="link-modal-prompt-wrapper">
          <textarea id="linkModalPromptInput" data-i18n-placeholder="linkModal.placeholder" placeholder="Ví dụ: Trang giới thiệu với thông tin công ty, đội ngũ, tầm nhìn..."></textarea>
          <div class="link-modal-prompt-ghost" id="linkModalPromptGhost" aria-hidden="true"><span class="ghost-typed" id="linkModalGhostTyped"></span><span class="ghost-suggestion" id="linkModalGhostSuggestion"></span></div>
        </div>
        <div class="link-modal-actions">
          <button id="linkModalCancel" class="btn btn-secondary" data-i18n="linkModal.cancel">Hủy</button>
          <button id="linkModalConfirm" class="btn btn-primary" data-i18n="linkModal.confirm">Tạo trang</button>
        </div>
      </div>
    </div>
    <!-- Dynamic Island Toast -->
    <div id="status" class="toast-island"></div>
  </div>

  <script src="db.js"></script>
  <script src="icons.js"></script>
  <script src="i18n.js"></script>
  <script src="options.js"></script>
</body>
</html>
